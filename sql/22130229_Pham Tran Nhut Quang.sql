CREATE DATABASE QUANLYBANHANG;
GO

USE QUANLYBANHANG;
GO

CREATE TABLE MANUFACTURER (
                FAC_ID INT NOT NULL IDENTITY,
				NAME VARCHAR(255) NOT NULL,
				COUNTRY VARCHAR(255),
				CONTACT_NUM VARCHAR(50),
				CITY VARCHAR(255),
				PRIMARY KEY (FAC_ID)
);


CREATE TABLE STORE (
                STORE_ID INT NOT NULL IDENTITY,
				STORE_NAME VARCHAR(255) NOT NULL,
				CONTACT_NUM VARCHAR(50),
				EMAIL VARCHAR(255),
				STREET VARCHAR(255),
				CITY VARCHAR(255),
				PRIMARY KEY (STORE_ID)
);


CREATE TABLE CATEGORY (
                CATEGORY_ID INT NOT NULL IDENTITY,
                NAME VARCHAR(255) NOT NULL,
                PRIMARY KEY (CATEGORY_ID)
);


CREATE TABLE PRODUCT (
                PRODUCT_ID INT NOT NULL IDENTITY,
				CATEGORY_ID INT NOT NULL,
				FAC_ID INT NOT NULL,
				NAME VARCHAR(255) NOT NULL,
				DESCRIPTION VARCHAR(255),
				COLOR VARCHAR(50) NOT NULL,
				SIZE INT NOT NULL,
				WEIGHT DOUBLE PRECISION NOT NULL,
				WARRANTY VARCHAR(255) NOT NULL,
				PRICE DOUBLE PRECISION NOT NULL,
				PRIMARY KEY (PRODUCT_ID),
				FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY(CATEGORY_ID),
				FOREIGN KEY (FAC_ID) REFERENCES MANUFACTURER(FAC_ID)
);


CREATE TABLE STOCK (
                STOCK_ID INT NOT NULL IDENTITY,
                CATEGORY_ID INT NOT NULL,
                PRODUCT_ID INT NOT NULL,
                STORE_ID INT NOT NULL,
                QUANTITY INT NOT NULL,
				FAC_ID INT NOT NULL,
                PRIMARY KEY (STOCK_ID),
				FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY(CATEGORY_ID),
				FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID),
				FOREIGN KEY (STORE_ID) REFERENCES STORE(STORE_ID),
				FOREIGN KEY (FAC_ID) REFERENCES MANUFACTURER(FAC_ID)
);


CREATE TABLE ACCOUNT (
                ACCOUNT_ID INT NOT NULL IDENTITY,
                ACC_NAME VARCHAR(255) NOT NULL,
                PASSWORD VARCHAR(255) NOT NULL,
                CREATE_DATE DATE NOT NULL,
                STATUS VARCHAR(255),
                ACCOUNT_TYPE VARCHAR(255) NOT NULL,
                PRIMARY KEY (ACCOUNT_ID)
);


CREATE TABLE EMPLOYEE (
                EMP_ID INT NOT NULL IDENTITY,
				ACCOUNT_ID INT NOT NULL,
				STORE_ID INT NOT NULL,
				FIRST_NAME VARCHAR(255) NOT NULL,
				LAST_NAME VARCHAR(255) NOT NULL,
				PHONE_NUMBER VARCHAR(50),
				MANAGER_ID INT,
				Parent_EMP_ID INT,
				Parent_ACCOUNT_ID INT,
				PRIMARY KEY (EMP_ID),
				FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT(ACCOUNT_ID),
				FOREIGN KEY (STORE_ID) REFERENCES STORE(STORE_ID)
);


CREATE TABLE CUSTOMER (
                CUS_ID INT NOT NULL IDENTITY,
				ACCOUNT_ID INT NOT NULL,
				FIRST_NAME VARCHAR(255) NOT NULL,
				LAST_NAME VARCHAR(255) NOT NULL,
				PHONE_NUMBER VARCHAR(50),
				ADDRESS VARCHAR(255),
				PRIMARY KEY (CUS_ID),
				FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT(ACCOUNT_ID)
);


CREATE TABLE ORDERS (
                ORDER_ID INT NOT NULL IDENTITY,
                CUS_ID INT NOT NULL,
                ACCOUNT_ID INT NOT NULL,
                ORDER_DATE DATE NOT NULL,
                TOTAL_AMOUNT FLOAT NOT NULL,
                PRIMARY KEY (ORDER_ID),
				FOREIGN KEY (CUS_ID) REFERENCES CUSTOMER(CUS_ID),
				FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT(ACCOUNT_ID)
);


CREATE TABLE TRANSACTIONS (
        TRANSAC_ID INT NOT NULL IDENTITY,
		ORDER_ID INT NOT NULL,
		CUS_ID INT NOT NULL,
		ACCOUNT_ID INT NOT NULL,
		TRANSAC_DATE DATE NOT NULL,
		AMOUNT DOUBLE PRECISION NOT NULL,
		STATUS VARCHAR(50),
		TRANSAC_TYPE VARCHAR(50),
		PRIMARY KEY (TRANSAC_ID),
		FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID),
		FOREIGN KEY (CUS_ID) REFERENCES CUSTOMER(CUS_ID),
		FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT(ACCOUNT_ID)
);



CREATE TABLE ORDER_DETAIL (
                ORDER_DETAIL_ID INT NOT NULL,
                ORDER_ID INT NOT NULL,
                CUS_ID INT NOT NULL,
                ACCOUNT_ID INT NOT NULL,
                PRODUCT_ID INT NOT NULL,
				FAC_ID INT NOT NULL,
                CATEGORY_ID INT NOT NULL,  
                QUANTITY INT NOT NULL,
                PRICE_PER_PRODUCT float NOT NULL,
                PRIMARY KEY (ORDER_DETAIL_ID),
				FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID),
				FOREIGN KEY (CUS_ID) REFERENCES CUSTOMER(CUS_ID),
				FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT(ACCOUNT_ID),
				FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID),
				FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY(CATEGORY_ID),
				FOREIGN KEY (FAC_ID) REFERENCES MANUFACTURER(FAC_ID)
);

SET IDENTITY_INSERT MANUFACTURER ON;
INSERT INTO MANUFACTURER(FAC_ID, NAME, COUNTRY, CONTACT_NUM, CITY)
VALUES
(1001, 'Samsung', 'Hàn Quốc', '0123456789', 'Seoul '),
(1002, 'Apple', 'Mỹ', '0987654321', 'New York'),
(1003, 'Sony', 'Nhật Bản', '0345678901', 'Kyoto'),
(1004, 'LG', 'Hàn Quốc', '0567890123', 'Inchoen'),
(1005, 'Xiaomi', 'Trung Quốc', '0789012345', 'Shanghai');
SET IDENTITY_INSERT MANUFACTURER OFF;

SET IDENTITY_INSERT CATEGORY ON;
INSERT INTO CATEGORY(CATEGORY_ID, NAME) 
VALUES
(101, 'Điện thoại'),
(102, 'Máy tính bảng'),
(103, 'Máy tính xách tay'),
(104, 'Tivi'),
(105, 'Đồng hồ thông minh');
SET IDENTITY_INSERT CATEGORY OFF;

SET IDENTITY_INSERT PRODUCT ON;
INSERT INTO PRODUCT(PRODUCT_ID, FAC_ID, NAME, DESCRIPTION, CATEGORY_ID, SIZE, WEIGHT, WARRANTY, PRICE)
VALUES
(1, 1001, 'Samsung Galaxy S21', 'Điện thoại thông minh cao cấp', 'Đen',6, 0.169,'12 tháng', 20000000),
(2, 1002, 'iPad Pro', 'Máy tính bảng mạnh mẽ từ Apple', 'Bạc', 11, 0.47,'12 tháng', 25000000),
(3, 1003, 'Sony Vaio', 'Máy tính xách tay tiện lợi', 'Trắng',15, 1.5,' tháng', 30000000),
(4, 1004, 'LG OLED TV', 'Tivi OLED siêu nét', 'Đen', 55, 10.2,'36 tháng', 40000000),
(5, 1005, 'Xiaomi Mi Band 6', 'Đồng hồ thông minh giá rẻ', 'Đen',1, 0.024,'6 tháng', 1000000);
SET IDENTITY_INSERT PRODUCT OFF;

SET IDENTITY_INSERT ACCOUNT ON;
INSERT INTO ACCOUNT(ACCOUNT_ID, ACC_NAME, PASSWORD, CREATE_DATE, STATUS, ACCOUNT_TYPE) 
VALUES
(2001, 'nguyenvana', 'password123', '2023-01-01', 'Hoạt động', 'Nhân viên'),
(2002, 'tranthib', 'pass123', '2023-01-02', 'Hoạt động', 'Khách hàng'),
(2003, 'leminhc', 'leminhc123', '2023-01-03', 'Khóa', 'Nhân viên'),
(2004, 'ngothid', 'ngothidpass', '2023-01-04', 'Hoạt động', 'Quản lý'),
(2005, 'phamanh', 'phamanh123', '2023-01-05', 'Hoạt động', 'Khách hàng'),
(2006, 'lehong', 'lehong123', '2023-01-12', 'Hoạt động', 'Nhân viên'),
(2007, 'khuonglinh', 'khuonglinhpass', '2023-01-09', 'Hoạt động', 'Quản lý'),
(2008, 'nguyenkieu', 'nguyenkieu123', '2023-01-06', 'Hoạt động', 'Nhân viên');
SET IDENTITY_INSERT ACCOUNT OFF;

SET IDENTITY_INSERT EMPLOYEE ON;
INSERT INTO EMPLOYEE(EMP_ID, ACCOUNT_ID, FIRST_NAME, LAST_NAME, PHONE_NUMBER, MANAGER_ID) VALUES
(3001, 2003, 'Lê', 'Minh', '0123456789', 2),
(3002, 2004, 'Ngô', 'Thị', '0987654321', 2),
(3003, 2006, 'Nguyễn', 'An', '0345678901', 5),
(3004, 2007, 'Trần', 'Bình', '0567890123', 5),
(3005, 2008, 'Khuong', 'Linh', '0091661782', 5);
SET IDENTITY_INSERT EMPLOYEE OFF;

SET IDENTITY_INSERT STORE ON;
INSERT INTO STORE(STORE_ID, STORE_NAME, CONTACT_NUM, EMAIL, STREET, CITY)
VALUES
(4001, 'Cửa hàng A', '0123456789', 'cuahanga@gmail.com', '123 Đường A', 'Hà Nội'),
(4002, 'Cửa hàng B', '0987654321', 'cuahangb@yahoo.com', '456 Đường B', 'Hồ Chí Minh'),
(4003, 'Cửa hàng C', '0345678901', 'cuahangc@outlook.com', '789 Đường C', 'Đà Nẵng'),
(4004, 'Cửa hàng D', '0567890123', 'cuahangd@gmail.com', '101 Đường D', 'Hải Phòng'),
(4005, 'Cửa hàng E', '0789012345', 'cuahangae@yahoo.com', '202 Đường E', 'Cần Thơ');
SET IDENTITY_INSERT STORE OFF;

SET IDENTITY_INSERT STOCK ON;
INSERT INTO STOCK(STOCK_ID, CATEGORY_ID, PRODUCT_ID, STORE_ID, QUANTITY, FAC_ID)
VALUES
(5001,101, 1, 4001,50, 1001),
(5002,102, 2, 4002,30, 1002),
(5003,103, 3, 4003,20, 1003),
(5004,104, 4, 4004,10, 1004),
(5005,105, 5, 4005,100, 1005);
SET IDENTITY_INSERT STOCK OFF;

SET IDENTITY_INSERT CUSTOMER ON;
INSERT INTO CUSTOMER(CUS_ID, ACCOUNT_ID, LAST_NAME, FIRST_NAME, PHONE_NUMBER, ADDRESS)
VALUES
(6001, 2001, 'Pham', 'Thi Thanh', '0389382829', '122 Phố D, Vinh'),
(6002, 2002, 'Pham', 'Văn Anh', '0123456789', '123 Phố X, Hà Nội'),
(6003, 2005, 'Trần', 'Thị Bi', '0987654321', '456 Phố Y, Hồ Chí Minh');
SET IDENTITY_INSERT CUSTOMER OFF;

SET IDENTITY_INSERT ORDERS ON;
INSERT INTO ORDERS(ORDER_ID, CUS_ID, ACCOUNT_ID, ORDER_DATE, TOTAL_AMOUNT)
VALUES
(7001, 6001, 2001, '2023-08-01', 20000000),
(7002, 6002, 2002, '2023-08-02', 25000000),
(7003, 6002, 2002, '2023-08-03', 30000000),
(7004, 6001, 2001, '2023-08-04', 40000000),
(7005, 6005, 2005, '2023-08-05', 1000000);
SET IDENTITY_INSERT ORDERS OFF;

SET IDENTITY_INSERT TRANSACTIONS ON;
INSERT INTO TRANSACTIONS(TRANSAC_ID, ORDER_ID, CUS_ID, ACCOUNT_ID, TRANSAC_DATE, AMOUNT, STATUS, TRANSAC_TYPE)
VALUES
(8001, 7001, 6001, 2001, '2023-08-01', 20000000, 'Thành công', 'Thanh toán'),
(8002, 7002, 6002, 2002, '2023-08-02', 25000000, 'Thành công', 'Thanh toán'),
(8003, 7003, 6002, 2002, '2023-08-03', 30000000, 'Thành công', 'Thanh toán'),
(8004, 7004, 6001, 2001, '2023-08-04', 40000000, 'Thành công', 'Thanh toán'),
(8005, 7005, 6005, 2005, '2023-08-05', 1000000, 'Thành công', 'Thanh toán');
SET IDENTITY_INSERT TRANSACTIONS OFF;

SET IDENTITY_INSERT ORDER_DETAIL ON;
INSERT INTO ORDER_DETAIL(ORDER_DETAIL_ID, ORDER_ID, CUS_ID, ACCOUNT_ID, PRODUCT_ID, FAC_ID, QUANTITY, PRICE_PER_PRODUCT)
VALUES
(9001, 7001, 6001, 2001, 1, 1001, 1, 20000000),
(9002, 7002, 6002, 2002, 2, 1002, 1, 25000000),
(9003, 7003, 6002, 2002, 3, 1003, 1, 30000000),
(9004, 7004, 6001, 2001, 4, 1004, 1, 40000000),
(9005, 7005, 6005, 2005, 5, 1005, 1, 1000000);
SET IDENTITY_INSERT ORDER_DETAIL OFF;